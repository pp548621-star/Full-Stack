# üìò Unit 3 ‚Äî Assignment 1 

## A. One-time Setup (Run first)

> Dialect: ANSI-SQL leaning toward MySQL/PostgreSQL. If your SQL engine needs tweaks (e.g., `SERIAL`, identity syntax), adapt accordingly.

```sql
-- 1) Create DB and use it (use \c CodingGitaDB in psql)
CREATE DATABASE CodingGitaDB;
-- MySQL:
USE CodingGitaDB;

-- 2) Core tables
CREATE TABLE Department (
  DeptID VARCHAR(10) PRIMARY KEY,
  DeptName VARCHAR(50) UNIQUE NOT NULL
);

CREATE TABLE Faculty (
  FacultyID VARCHAR(10) PRIMARY KEY,
  Name VARCHAR(50) NOT NULL,
  DeptID VARCHAR(10) NOT NULL,
  Phone VARCHAR(15),
  CONSTRAINT fk_faculty_dept
    FOREIGN KEY (DeptID) REFERENCES Department(DeptID)
);

CREATE TABLE Course (
  CourseID VARCHAR(10) PRIMARY KEY,
  Title VARCHAR(50) NOT NULL,
  Credits INT CHECK (Credits BETWEEN 1 AND 6),
  DeptID VARCHAR(10) NOT NULL,
  FacultyID VARCHAR(10) NOT NULL,
  CONSTRAINT fk_course_dept
    FOREIGN KEY (DeptID) REFERENCES Department(DeptID),
  CONSTRAINT fk_course_faculty
    FOREIGN KEY (FacultyID) REFERENCES Faculty(FacultyID)
);

CREATE TABLE Student (
  RollNo INT PRIMARY KEY,
  Name VARCHAR(50) NOT NULL,
  Semester INT CHECK (Semester BETWEEN 1 AND 8),
  City VARCHAR(30) DEFAULT 'Ahmedabad',
  Email VARCHAR(80) UNIQUE
);

CREATE TABLE Enrollment (
  RollNo INT NOT NULL,
  CourseID VARCHAR(10) NOT NULL,
  Marks INT CHECK (Marks BETWEEN 0 AND 100),
  PRIMARY KEY (RollNo, CourseID),
  CONSTRAINT fk_enr_student FOREIGN KEY (RollNo) REFERENCES Student(RollNo),
  CONSTRAINT fk_enr_course  FOREIGN KEY (CourseID) REFERENCES Course(CourseID)
);

-- 3) Seed data
INSERT INTO Department (DeptID, DeptName) VALUES
('CSE','Computer Science & Engineering'),
('IT','Information Technology'),
('ECE','Electronics & Communication');

INSERT INTO Faculty (FacultyID, Name, DeptID, Phone) VALUES
('F001','Krishna Shah','CSE','9876500011'),
('F002','Yashvi Mehta','CSE','9876500022'),
('F003','Priyesha Rao','IT','9876500033'),
('F004','Arjun Patel','ECE','9876500044');

INSERT INTO Course (CourseID, Title, Credits, DeptID, FacultyID) VALUES
('CS101','DBMS',4,'CSE','F001'),
('CS102','DSA',4,'CSE','F002'),
('CS103','Operating Systems',3,'IT','F003'),
('CS104','Web Development',3,'CSE','F002'),
('EC201','Digital Electronics',4,'ECE','F004');

INSERT INTO Student (RollNo, Name, Semester, City, Email) VALUES
(101,'Jenil',3,'Ahmedabad','jenil@codinggita.in'),
(102,'Mahir',3,'Surat','mahir@codinggita.in'),
(103,'Arjun',3,'Vadodara','arjun@codinggita.in'),
(104,'Yashvi',3,'Rajkot','yashvi@codinggita.in'),
(105,'Neel',2,'Surat','neel@codinggita.in'),
(106,'Krishna',2,'Ahmedabad','krishna@codinggita.in'),
(107,'Riya',4,'Ahmedabad','riya@codinggita.in'),
(108,'Dev',4,'Rajkot','dev@codinggita.in'),
(109,'Ishita',1,'Vadodara','ishita@codinggita.in'),
(110,'Harsh',1,'Surat','harsh@codinggita.in'),
(111,'Kunal',5,'Ahmedabad','kunal@codinggita.in'),
(112,'Meera',5,'Surat','meera@codinggita.in');

INSERT INTO Enrollment (RollNo, CourseID, Marks) VALUES
(101,'CS101',92),(101,'CS102',81),(101,'CS104',78),
(102,'CS101',76),(102,'CS102',84),
(103,'CS101',95),(103,'CS103',85),
(104,'CS103',85),(104,'CS104',74),
(105,'CS102',69),
(106,'CS101',88),
(107,'CS101',73),(107,'CS104',80),
(108,'EC201',72),
(109,'CS103',64),
(110,'CS104',67),
(111,'CS101',91),(111,'CS102',88),(111,'EC201',79),
(112,'CS103',83);
```

---

## B. Tasks (Attempt in order)

> Unless the task says ‚Äúshow output‚Äù, you only need to write and run the SQL. Keep all answers in a single `.sql` file or a Jupyter/Notebook cell series if you prefer.

### DDL ‚Äî CREATE/ALTER/DROP (1‚Äì8)

1. **Create** a table `Classroom(RoomID, Capacity, DeptID)` with:

   * `RoomID` (PK, VARCHAR(10)),
   * `Capacity` (INT, `CHECK Capacity BETWEEN 20 AND 120`),
   * `DeptID` FK ‚Üí `Department(DeptID)`.
2. **ALTER** `Classroom` to add a column `Projector BOOLEAN` with default `TRUE` (use `BOOLEAN` or `TINYINT(1)` as per your DB).
3. **ALTER** `Student` to **increase** `City` length to 50 and **rename** `City` ‚Üí `Hometown`. (Use appropriate syntax for your engine.)
4. **Create** a view `v_student_basic(RollNo, Name, Semester, Hometown)` selecting those columns from `Student`.
5. **Create** a view `v_course_faculty(CourseID, Title, FacultyName, DeptName)` joining `Course`, `Faculty`, `Department`.
6. **DROP** view `v_student_basic` and recreate it as `v_student_contact` adding `Email`.
7. **TRUNCATE** `Classroom`, then **DROP** the table `Classroom`.
8. **Explain** (as a SQL comment in your script) the difference between `DROP`, `TRUNCATE`, `DELETE`.

### DML ‚Äî INSERT/UPDATE/DELETE (9‚Äì13)

9. Insert three new students:

   * (113,'Parth',2,'Bhavnagar','[parth@codinggita.in](mailto:parth@codinggita.in)'),
   * (114,'Sanya',4,'Surat','[sanya@codinggita.in](mailto:sanya@codinggita.in)'),
   * (115,'Aarav',6,'Ahmedabad','[aarav@codinggita.in](mailto:aarav@codinggita.in)').
10. Update **Harsh (RollNo=110)** semester to **2** and hometown to **Bharuch**.
11. Transfer **Course CS104** to **Faculty F001** (update `Course.FacultyID`).
12. Delete any **Enrollment** where `Marks < 60`.
13. Insert Enrollment for **Parth(113)** into **CS101** with `Marks=71`.

### DQL ‚Äî SELECT + Filtering + ORDER BY + DISTINCT + LIMIT (14‚Äì19)

14. List **all students** (all columns), **sorted by Name ASC**.
15. Show **Name, Semester, Hometown** for students from **Surat** or **Rajkot**, ordered by **Semester DESC, Name ASC**.
16. Display **distinct hometowns** present in `Student`.
17. Show top **5** highest **Marks** across all enrollments with Student Name and Course Title.
18. Find students with names **starting with ‚ÄòJ‚Äô or ‚ÄòK‚Äô** (use `LIKE` with multiple patterns).
19. Show students whose **RollNo between 102 and 109** (inclusive).

### Constraints (20‚Äì22)

20. Add a `CHECK` on `Student.Email` to ensure it contains `'@'` (use a simple `LIKE '%@%'` if your DB supports check on pattern).
21. Try inserting a `Student` with **duplicate Email** and capture the error comment in your script.
22. Insert a `Student` with `Semester=10` and show that the **CHECK** fails (comment the error message).

### Functions (Aggregates, String, Numeric, Date) (23‚Äì27)

23. For each **Course**, show `CourseID, Title, COUNT(*) as Enrollments, AVG(Marks) as AvgMarks` (rounded to 2 decimals).
24. Show `UPPER(Name)` as `NameUpper`, `LOWER(Email)` as `EmailLower` for all students.
25. Show **first 3 letters** of each student name as `ShortName` (use `SUBSTR`/`SUBSTRING`).
26. Show **Marks**, \**CEIL(Marks/10.0)*10** as `RoundedToTens` for all enrollments.
27. Show **current date**, plus a column **one\_week\_later** using a date-add function.

### Joins (INNER/LEFT/RIGHT/FULL/CROSS/SELF) (28‚Äì32)

28. **INNER JOIN**: List `Student.Name, Course.Title, Enrollment.Marks`.
29. **LEFT JOIN**: List all `Student.Name` with their `Course.Title` (students with no enrollment should still appear with `NULL` course).
30. **RIGHT JOIN** (or simulate with LEFT if engine lacks RIGHT): List all courses and any students enrolled (courses with no students should appear).
31. **CROSS JOIN**: Produce all possible pairs of `Student.Name` and `Course.Title` (show only first 15 rows using LIMIT/TOP).
32. **SELF JOIN**: List **pairs of students** from the **same hometown** (avoid duplicates like A‚ÄìB and B‚ÄìA).

### GROUP BY & HAVING (33‚Äì35)

33. Show **count of students per hometown** (City/Hometown).
34. Show **average marks per course** but **only** for courses with **AVG(Marks) ‚â• 80** (`HAVING`).
35. Show **departments** with **more than 2 courses**.

### Set Operations (36‚Äì37)

> If your engine lacks `INTERSECT/EXCEPT`, emulate with joins/subqueries.

36. `UNION`: List all **cities from Student** and all **department names** from Department in a single column `Value` (remove duplicates).
37. `INTERSECT` or equivalent: Show values that appear **both** in `Student.Hometown` **and** as some `Department.DeptName` (likely none; this tests your technique).

### Subqueries (Simple/Correlated/EXISTS) (38‚Äì40)

38. **Simple subquery**: List students whose **Marks** are **greater than overall average** (use a subquery on `Enrollment`).
39. **Correlated subquery**: For each student row, show those who have **any course marks** **greater than the average marks of that same course**.
40. **EXISTS/NOT EXISTS**: List students who **are not enrolled** in any course.

---

## Notes / Hints

* If you hit FK violations, double-check the **order** of inserts and the **keys** you reference.
* For RIGHT/FULL OUTER JOIN on MySQL, simulate via `UNION` of LEFT JOINs; for Postgres, FULL OUTER JOIN is available.
* Keep all **error outputs as SQL comments** right below the failing statement to document the constraint behavior.
* Always test queries after each change‚ÄîDDL changes can affect later tasks.

---
